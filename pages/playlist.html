<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Playlist</title>
        <script src="/js/jquery-3.7.1.slim.min.js"></script>
        <script src="/js/common.js"></script>
        <script>
            async function getData() {
                const params = getParameters();
                const res = await fetch(
                    `/api/get-playlist-data?playlistId=${params["id"]}`
                );
                if (res.status === 404) {
                    //TODO: error
                    return;
                }
                const data = await res.json();
                console.log(data);

                $("#Name").text(data.Name);
                $("#Image").attr(
                    "src",
                    `/media/images/playlists/${data._id}.png`
                );
                $("#Duration").text(getDuration(data.TotalDuration));

                data.songs.forEach(async (song) => {
                    const res = await fetch(
                        `/api/get-song-data?songId=${song.SongID}`
                    );
                    if (res.status === 404) {
                        //TODO: error
                        return;
                    }
                    const data = await res.json();
                    $("#songsContainer").append(songCard(data._id, data.Name, data.Duration));
                });

                //TODO: Use data
            }
            getData();
        </script>
    </head>
    <body>
        <img id="Image" />
        <h1 id="Name"></h1>
        <span id="Duration"></span>
        <div id="songsContainer"></div>
    </body>
</html>
